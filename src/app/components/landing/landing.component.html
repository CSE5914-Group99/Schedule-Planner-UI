<div class="landing">
  <h2 class="title">Schedule Planner</h2>

  <!-- Upcoming at top -->
  <section class="card upcoming-card">
    <h3>Upcoming (next 5)</h3>
    <div *ngIf="!upcoming.length" class="muted empty-state">No upcoming items.</div>
    <div class="upcoming-list" *ngIf="upcoming.length">
      <div class="upcoming-item" *ngFor="let u of upcoming">
        <div class="upcoming-time">
          <div class="day">{{ u.date }}</div>
          <div class="time">{{ u.start }} - {{ u.end }}</div>
        </div>
        <div class="upcoming-details">
          <div class="upcoming-title">
            <span class="tag" [class.event]="u.type === 'event'">{{ u.type }}</span>
            {{ u.title }}
          </div>
          <div class="upcoming-meta" *ngIf="u.location || u.instructor">
            <span *ngIf="u.instructor">üë§ {{ u.instructor }}</span>
            <span *ngIf="u.location">üìç {{ u.location }}</span>
          </div>
        </div>
        <button
          *ngIf="u.type === 'class' && u.courseId"
          class="details-btn"
          (click)="
            onCourseDetailsRequested({
              courseId: u.courseId!,
              teacherName: u.instructor,
              courseTitle: u.title,
            })
          "
        >
          More Details
        </button>
      </div>
    </div>
  </section>

  <div class="layout">
    <!-- Left Difficulty -->
    <aside class="card side">
      <h4>Estimated Difficulty</h4>
      <p class="muted">
        This schedule has an estimated difficulty score of
        <strong>{{ schedule.difficultyScore | number: '1.0-0' }}</strong
        >.
      </p>
      <p class="muted" *ngIf="schedule.weeklyHours">
        Estimated workload: <strong>{{ schedule.weeklyHours | number: '1.1-1' }}</strong> hours per
        week.
      </p>

      <div class="divider"></div>

      <button class="btn" (click)="router.navigate(['/schedule/new'])">
        Open Schedule Builder
      </button>
      <button class="btn" (click)="router.navigate(['/schedules'])">View saved schedules</button>
    </aside>

    <!-- Schedule -->
    <app-weekly-schedule
      [schedule]="schedule"
      (courseDetailsRequested)="onCourseDetailsRequested($event)"
    ></app-weekly-schedule>
  </div>

  <!-- Course Rating Dialog -->
  @if (showCourseRatingDialog() && ratingCourseId()) {
    <div class="dialog-overlay" (click)="closeCourseRatingDialog()">
      <div class="dialog-content" (click)="$event.stopPropagation()">
        <app-course-rating-dialog
          [courseId]="ratingCourseId()!"
          [teacherName]="ratingTeacherName()"
          [courseTitle]="ratingCourseTitle()"
          (close)="closeCourseRatingDialog()"
          (ratingLoaded)="onRatingLoaded($event)"
        >
        </app-course-rating-dialog>
      </div>
    </div>
  }

  <!-- builder form removed on landing (read-only page) -->
</div>
