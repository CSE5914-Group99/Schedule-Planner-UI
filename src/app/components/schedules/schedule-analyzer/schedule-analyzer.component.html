<div class="analyzer-container">
  <div class="analyzer-header">
    <h2>Schedule Analysis</h2>
    <button class="close-btn" (click)="close.emit()">Ã—</button>
  </div>

  <div class="metrics-grid">
    <div
      class="metric-card difficulty"
      [class.high]="(schedule.difficultyScore || 0) > 7"
      [class.medium]="(schedule.difficultyScore || 0) > 4 && (schedule.difficultyScore || 0) <= 7"
      [class.low]="(schedule.difficultyScore || 0) <= 4"
    >
      <div class="metric-value">{{ schedule.difficultyScore | number: '1.1-1' }}</div>
      <div class="metric-label">Difficulty Score</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">{{ schedule.weeklyHours || 0 }}</div>
      <div class="metric-label">Weekly Hours</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">{{ schedule.creditHours || 0 }}</div>
      <div class="metric-label">Credit Hours</div>
    </div>
  </div>

  <div class="courses-analysis">
    <h3>Course Breakdown</h3>
    <div class="course-list">
      @for (course of schedule.courses; track course.id) {
        <div class="course-item">
          <div class="course-header">
            <span class="course-id">{{ course.courseId }}</span>
            <span
              class="course-rating"
              [class.high]="(course.difficultyRating || 0) > 3.5"
              [class.medium]="
                (course.difficultyRating || 0) > 2.5 && (course.difficultyRating || 0) <= 3.5
              "
            >
              Difficulty: {{ course.difficultyRating || 'N/A' }}
            </span>
          </div>
          <div class="course-details">
            <div class="detail-row">
              <span class="label">Instructor:</span>
              <span class="value">{{ course.instructor || 'TBA' }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Time:</span>
              <span class="value">{{ formatTime(course) }}</span>
            </div>
            @if (course.mode) {
              <div class="detail-row">
                <span class="label">Mode:</span>
                <span class="value">{{ course.mode }}</span>
              </div>
            }
          </div>
          @if (course.difficultyRating) {
            <div class="rating-bar-container">
              <div
                class="rating-bar"
                [style.width.%]="((course.difficultyRating || 0) / 5) * 100"
              ></div>
            </div>
          }
        </div>
      }
    </div>
  </div>

  <div class="analyzer-actions">
    <button class="btn secondary-btn" (click)="close.emit()">Close</button>
    <button class="btn primary-btn" (click)="confirm.emit()">Select This Schedule</button>
  </div>
</div>
